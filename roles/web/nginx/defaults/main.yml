---
# Nginx installation settings
nginx_package_name: nginx
nginx_use_official_repo: false
nginx_version: ""  # Leave empty for latest

# Service settings
nginx_service_name: nginx
nginx_service_enabled: true
nginx_service_state: started

# Main nginx.conf settings
nginx_user: "{{ 'www-data' if ansible_os_family == 'Debian' else 'nginx' }}"
nginx_worker_processes: auto
nginx_worker_connections: 1024
nginx_multi_accept: "on"
nginx_pid_file: /run/nginx.pid
nginx_error_log: /var/log/nginx/error.log
nginx_error_log_level: warn
nginx_access_log: /var/log/nginx/access.log

# HTTP settings
nginx_sendfile: "on"
nginx_tcp_nopush: "on"
nginx_tcp_nodelay: "on"
nginx_keepalive_timeout: 65
nginx_types_hash_max_size: 2048
nginx_server_tokens: "off"
nginx_client_max_body_size: 64m

# Gzip settings
nginx_gzip: "on"
nginx_gzip_vary: "on"
nginx_gzip_proxied: any
nginx_gzip_comp_level: 6
nginx_gzip_types:
  - text/plain
  - text/css
  - text/xml
  - application/json
  - application/javascript
  - application/xml
  - application/xml+rss
  - application/x-javascript
  - text/javascript

# SSL/TLS settings
nginx_ssl_enabled: false
nginx_ssl_protocols: "TLSv1.2 TLSv1.3"
nginx_ssl_ciphers: "ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384"
nginx_ssl_prefer_server_ciphers: "on"
nginx_ssl_session_cache: "shared:SSL:10m"
nginx_ssl_session_timeout: "1d"
nginx_ssl_session_tickets: "off"

# SSL certificate paths (default self-signed location)
nginx_ssl_certificate: /etc/ssl/certs/nginx-selfsigned.crt
nginx_ssl_certificate_key: /etc/ssl/private/nginx-selfsigned.key
nginx_ssl_dhparam: /etc/ssl/certs/dhparam.pem
nginx_ssl_generate_dhparam: false
nginx_ssl_dhparam_size: 2048

# Self-signed certificate generation
nginx_ssl_generate_self_signed: false
nginx_ssl_self_signed_subject: "/C=US/ST=State/L=City/O=Organization/CN=localhost"

# Security headers
nginx_security_headers:
  X-Frame-Options: "SAMEORIGIN"
  X-Content-Type-Options: "nosniff"
  X-XSS-Protection: "1; mode=block"
  Referrer-Policy: "strict-origin-when-cross-origin"

# HSTS settings (only applied when SSL is enabled)
nginx_hsts_enabled: true
nginx_hsts_max_age: 31536000
nginx_hsts_include_subdomains: true
nginx_hsts_preload: false

# Virtual hosts
nginx_vhosts: []
# Example:
# nginx_vhosts:
#   - server_name: example.com
#     listen: 80
#     root: /var/www/example.com
#     index: index.html index.htm
#     ssl: false
#     ssl_certificate: /etc/ssl/certs/example.crt
#     ssl_certificate_key: /etc/ssl/private/example.key
#     locations:
#       - path: /
#         options:
#           - try_files $uri $uri/ =404
#     extra_config: ""

# Default virtual host settings
nginx_default_root: /var/www/html
nginx_remove_default_vhost: false

# Directory settings
nginx_conf_dir: /etc/nginx
nginx_vhost_dir: "{{ nginx_conf_dir }}/sites-available"
nginx_vhost_enabled_dir: "{{ nginx_conf_dir }}/sites-enabled"
nginx_conf_d_dir: "{{ nginx_conf_dir }}/conf.d"

# Log format
nginx_log_format: |
  '$remote_addr - $remote_user [$time_local] "$request" '
  '$status $body_bytes_sent "$http_referer" '
  '"$http_user_agent" "$http_x_forwarded_for"'
